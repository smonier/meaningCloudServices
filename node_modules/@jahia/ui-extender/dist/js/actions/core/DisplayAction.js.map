{"version":3,"names":["_react","_interopRequireDefault","require","_registry","_excluded","_excluded2","ownKeys","object","enumerableOnly","keys","Object","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","target","i","arguments","length","source","forEach","key","_defineProperty2","getOwnPropertyDescriptors","defineProperties","defineProperty","_createSuper","Derived","hasNativeReflectConstruct","_isNativeReflectConstruct","_createSuperInternal","Super","_getPrototypeOf2","result","NewTarget","constructor","Reflect","construct","_possibleConstructorReturn2","sham","Proxy","Boolean","prototype","valueOf","call","e","count","getRenderWrapper","Render","RenderWrapper","_ref","context","otherProps","_objectWithoutProperties2","createElement","_extends2","DisplayAction","_React$PureComponent","_inherits2","_super","props","_this","_classCallCheck2","id","actionKey","render","_createClass2","value","_this$props","loading","action","registry","get","console","warn","Component","component","mergedProps","componentProps","originalContext","init","info","type","targets","foundTarget","find","t","priority","buttonProps","React","PureComponent","exports","_propTypes","string","isRequired"],"sources":["DisplayAction.tsx"],"sourcesContent":["import React from 'react';\nimport {registry} from '~/registry';\nimport {StoredService} from '~/registry/service';\n\nlet count = 0;\n\nexport type DisplayActionProps = {\n    /**\n     * The key of the action to display\n     */\n    actionKey: string,\n    /**\n     * The action context\n     */\n    context?: object,\n    /**\n     * The render component\n     */\n    render: React.FunctionComponent<object>,\n    /**\n     * The render component\n     */\n    loading?: React.FunctionComponent<object>\n\n    [key: string]: unknown\n}\n\nconst getRenderWrapper = (Render: React.FunctionComponent): React.FunctionComponent => {\n    const RenderWrapper = ({context, ...otherProps}: React.PropsWithChildren<{context: object}>) => (\n        <Render {...context} {...otherProps}/>\n    );\n\n    return RenderWrapper;\n};\n\nclass DisplayAction extends React.PureComponent<DisplayActionProps> {\n    id: string;\n    RenderWrapper: React.FunctionComponent;\n\n    constructor(props: DisplayActionProps) {\n        super(props);\n        this.id = props.actionKey + '-' + (count++);\n        this.RenderWrapper = getRenderWrapper(props.render);\n    }\n\n    render() {\n        const {context, actionKey, render, loading, ...otherProps} = this.props;\n        const action: StoredService = registry.get('action', actionKey);\n\n        if (!action) {\n            return null;\n        }\n\n        if (context) {\n            console.warn('Warn : context in DisplayAction is deprecated', actionKey, context);\n        }\n\n        const Component = (typeof action.component === 'function') ? action.component : render;\n\n        // Merge props and context. To remove when context is not supported anymore\n        const mergedProps = {...context, ...otherProps};\n\n        const componentProps: {[key: string]: unknown, init?: ((ctx: object, props: object) => void)} = {...action, ...mergedProps, originalContext: mergedProps, id: this.id, actionKey};\n\n        if (componentProps.init) {\n            componentProps.init(componentProps, this.props);\n        }\n\n        const info: { [key: string]: unknown } = {};\n\n        info['data-registry-key'] = action.type + ':' + action.key;\n\n        if (otherProps.target && action.targets) {\n            const foundTarget = action.targets.find(t => t.id === otherProps.target);\n            if (foundTarget) {\n                info['data-registry-target'] = foundTarget.id + ':' + foundTarget.priority;\n            }\n        }\n\n        // Props are passed as as context and props. Context can be removed when not supported anymore\n        return (\n            <Component\n                key={this.id}\n                {...componentProps}\n                buttonProps={{\n                    ...(componentProps.buttonProps as object),\n                    ...info\n                }}\n                context={componentProps}\n                render={this.RenderWrapper}\n                loading={loading}\n            />\n        );\n    }\n}\n\nexport {DisplayAction};\n"],"mappings":"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"}